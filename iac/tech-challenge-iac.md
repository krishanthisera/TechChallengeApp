# Tech-Challenge-IaC
[![N|Solid](data:image/png;base64,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)](https://nodesource.com/products/nsolid)

An Elastic Kubernetes Cluster will be provisioned as the result of this execution.

## Primary Terraform modules 
1. [EKS Module](https://github.com/terraform-aws-modules/terraform-aws-eks) 
2. [VPC Module](https://github.com/terraform-aws-modules/terraform-aws-vpc)
## File Structure
| File | Description |
| ------ | ------ |
| [provider.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/provider.tf) | Describes Terraform Providers |
| [eks-cluster.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/eks-cluster.tf) | Describes the EKS cluster and it's Worker Nodes |
| [vpc.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/vpc.tf) | Describes AWS VPCs |
| [auto-scalling.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/auto-scalling.tf) | Describes resources, including policies to facilitate autoscalling |
| [ebs-volumes.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/ebs-volumes.tf) | Descibe AWS EBS Volume policies to facilitate the data persistency |
| [iam.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/iam.tf) | Describe essential IAM roles |
| [rbac.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/rbac.tf) | An optional config to create EKS role  |
| [load-balancer.tf_exculde](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/load-balancer.tf_exculde)| An optional configuration if it required provision K8s ingress _(required to remove "exclued")_|
| [variables.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/variables.tf)| All the Terraform variables are defined here|
|[terraform.tfvars](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/terraform.tfvars)|Holds values for the variables|
|[outputs.tf](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/outputs.tf)|Describes/templates Terraform output data|

## How to Run
Verify whether [terraform is installed](https://learn.hashicorp.com/tutorials/terraform/install-cli) in your computer,
```sh
$ terraform version
```
1. Define the all the required vaiable using [terraform.tfvars](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/terraform.tfvars) <br> It is reccomended that  **AWS_ACCESS_KEY_ID** and **AWS_SECRET_ACCESS_KEY** provide as enviorement variables,
      ```sh
        $ export AWS_ACCESS_KEY_ID=<YOUR_ACCESS_KEY>
        $ export AWS_SECRET_ACCESS_KEY=<YOUR_SECRET_KEY>
      ```
      Or even better to use [HashiCorp Vault](https://www.hashicorp.com/resources/managing-vault-with-terraform)
      optionally ingress can be enabled by using allowing [load-balancer.tf_exculde](https://github.com/krishanthisera/TechChallengeApp/blob/master/iac/load-balancer.tf_exculde) to execute.
2. Create terraform workspace and initialise terraform
      ```sh
        $ # cd into the Terraform directory 
        $ terraform workspace new development
        $ terraform init 
      ```
      It is recomended to maintain a centrlised directory to mange `.tfstate` file where Terraform stores its status of the deployment
3. Create the Terraform plan
     ```sh
        # cd into the Terraform directory 
        $ terraform plan -out=plan.tfplan -var-file=terraform.tfvars
      ```
4. Apply the changes 
     ```sh
        # cd into the Terraform directory 
        $ terraform apply development.tfplan
      ```
5. Configure `kubectl`
     ```sh
        # cd into the Terraform directory 
        $ terraform output kubectl_config > ~/.kube/config
      ```
6. Verify 
     ```sh
        # cd into the Terraform directory 
        $ kubectl cluster-info
      ```  
_Note that, to ingress to be installed it is required configure AWS Route53 in this case. It is assumed that base domain has already been configureds_
